
C       Вычисление полных эллиптических интегралов
C	EE,EK от RK2=k**2
C	Справочник по спец. ф-иям, ред. М.Абрамовиц, И.Стиган,
C	М.,"Наука",1979, стр.404-405.
C
	subroutine ELLIPS(RK2,EE,EK)
	real*8 AE1,AE2,AE3,AE4,BE1,BE2,BE3,BE4,EE8,EK8,R
	real*8 AK0,AK1,AK2,AK3,AK4,BK0,BK1,BK2,BK3,BK4,ED
	data AE1,AE2,AE3,AE4,BE1,BE2,BE3,BE4
     1/	0.44325141463,0.06260601220,0.04757383546,0.01736506451,
     2	0.24998368310,0.09200180037,0.04069697526,0.00526449639/
	data AK0,AK1,AK2,AK3,AK4,BK0,BK1,BK2,BK3,BK4
     1/	1.38629436112,0.09666344259,0.03590092383,0.03742563713,
     2	0.01451196212,0.5,
     3	0.12498593597,0.06880248576,0.03328355346,0.00441787012/
	data ED /1./
C
	R=ED-RK2
	if (R.lt.1.E-8) then
	    R=1.E-8
      endif
	RLN=dlog(ED/R)
	EE8=(((AE4*R+AE3)*R+AE2)*R+AE1)*R+ED+
     1	(((BE4*R+BE3)*R+BE2)*R+BE1)*R*RLN
	EK8=(((AK4*R+AK3)*R+AK2)*R+AK1)*R+AK0+
     1	((((BK4*R+BK3)*R+BK2)*R+BK1)*R+BK0)*RLN
	EE=EE8
	EK=EK8
c        write(*,*)' EE=',EE,' EK=',EK
	RETURN
	END


